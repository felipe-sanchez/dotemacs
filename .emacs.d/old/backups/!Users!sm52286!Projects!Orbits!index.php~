<?php
$pwd_md5 = "d07e4541bfdce1d8181bc0e5643e3d75";

if (!isset($_SERVER['PHP_AUTH_USER'])) {	
                                        header('WWW-Authenticate: Basic realm="SPC"');
                                        header('HTTP/1.0 401 Unauthorized');
                                        exit;
                                        } else if (md5($_SERVER['PHP_AUTH_PW']) != $pwd_md5) {
	header('WWW-Authenticate: Basic realm="SPC"');
  header('HTTP/1.0 401 Unauthorized');
	exit;
}
?>
<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>Super Planet Crush - Can you feel the gravity?</title>
    <meta name="author" content="Stefano Meschiari">
    <meta name="description" content="A game of gravity.">
    <link href='http://fonts.googleapis.com/css?family=Exo:400,500,600,700,900,400italic' rel='stylesheet' type='text/css'>
    <link href="libs/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="css/pcl.css" rel="stylesheet" type="text/css">
    <meta property="og:image" content="img/spc.png">
  </head>
  <body>
    <?php
    if (file_exists('data/salt.txt'))
      $salt = file_get_contents('data/salt.txt');
    else
      $salt = '';
    $token = md5($salt . $_SERVER['REMOTE_ADDR']);
    ?>
    <script>
     TOKEN = encodeURIComponent("<?= $token ?>");
     USE_TEMPLATE = false;
    </script>

    <canvas id="universe" resize="true" keepalive="true" hidpi="false"></canvas>
    <div id="sidebar">
      <div id="title">
        <a class="spc">
        <span class="white-color" id="title0">Super</span>
        <span class="base0C" id="title1">Planet</span>
        <span class="base0A" id="title2">Crush</span>
        </a>
      </div>
      <div id="cfg">
        Click on the type of body to add next:
        <ul class="nav nav-pills nav-stacked" id="masses">
          <li class="active">
            <a href="#" class="mass-sel" data-points="1">
              <span class="badge pull-right">1x</span>
              Earth
            </a>
          </li>
          <li>
            <a href="#" class="mass-sel" data-points="5">
              <span class="badge pull-right">5x</span>
              Super-Earth
            </a>
          </li>
          <li>
            <a href="#" class="mass-sel" data-points="15">
              <span class="badge pull-right">15x</span>
              Ice giant
            </a>
          </li>
          <li>
            <a href="#" class="mass-sel" data-points="300">
              <span class="badge pull-right">300x</span>
              Giant planet
            </a>
          </li>
          <li>
            <a href="#" class="mass-sel" data-points="5000">
              <span class="badge pull-right">5,000x</span>
              Brown dwarf
            </a>
          </li>
          <li>
            <a href="#" class="mass-sel" data-points="30000">
              <span class="badge pull-right">30,000x</span>
              Dwarf star
            </a>
          </li>
        </ul>
      </div>
      <div class="btn-group adjust-4">
        <button type="button" class="btn btn-default gray-pulse" id="slower" title="Slower"><span class="glyphicon glyphicon-backward"></span></button>      
        <button type="button" class="btn btn-default gray-pulse" id="faster" title="Faster"><span class="glyphicon glyphicon-forward"></span></button>
        <button type="button" class="btn btn-default gray-pulse" id="pause" title="Pause/Resume"><span class="glyphicon glyphicon-pause"></span></button>
        <button type="button" class="btn btn-default gray-pulse" id="screenshot" title="Take a screenshot"><span class="glyphicon glyphicon-camera"></button>
      </div>
      <div class="btn-group adjust-2">
        <button type="button" class="btn btn-default gray-pulse" id="help">Help</button>        
        <button type="button" class="btn btn-default gray-pulse" id="stop">End Game</button>
      </div>
      <div class="spacer"></div>
    </div>
    <div id="popup" style="display:none">
      <a href="#" onClick="javascript:$('#popup').hide();return false;"><span class="glyphicon glyphicon-remove-circle"></span> Close</a>
      <hr>
      <div id="pop-help">
        <div style="font-size:16px">
        To beat <span class="white-color" id="title0">Super</span>
        <span class="base0C" id="title1">Planet</span>
        <span class="base0A" id="title2">Crush</span>, create a planetary
        system that can survive for <strong>500</strong> years.
        </div>
        <hr>
        <ul>
          <li>You can gain more points by adding more bodies (up to 10 bodies). Add bodies by clicking anywhere.</li>
          <li>The more massive the body, the more points! From 1 point for an Earth-mass planet, to 30,000 for a stellar companion. But remember, each planet attracts each other gravitationally and you don't want your system to go KABOOM!</li>
          <li>You will lose the game if two bodies crash with each other, or if one of the bodies crashes against the 2-AU barrier (the gray circle)</li>
          
        </ul>
        <hr>
        <div class="btn-group">
        <button type="button" class="btn btn-info dropdown-toggle gray-pulse" data-toggle="dropdown">
          Templates <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" id="templates" role="menu">
          <li><a href="hey">Kepler-11</a></li>
          <li><a href="hey">HD141399</a></li>          
        </ul>
        </div>
        <hr>
        <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/" class="pull-right"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a>

      </div>
      <div id="pop-why" style="display:none">
        
      </div>
      <div id="pop-points" style="display:none">
        <div id="pop-points-calc"></div>
        <br>for a total of<br>
        
        <div class="pop-big" id="pop-points-tot"></div><br>points over<br>
        <div class="pop-big" id="pop-years-tot"></div> years!
        <hr>
        
        <form role="form" action="hiscore.php" id="hiscore-form">
          <div class="form-group">
            Share this address to show off your system:
            <input type="text" name="hiscore-url-full" id="hiscore-url-full" class="form-control" placeholder="Loading...">
            <hr>
            <input type="hidden" name="hiscore-url" id="hiscore-url">
            <input type="hidden" name="hiscore-points" id="hiscore-points">
            <input type="hidden" name="hiscore-years" id="hiscore-years">
            <input class="form-control" type="text" placeholder="Your name" id="hiscore-name" name="hiscore-name">
            <button type="submit" class="btn btn-primary" disabled="true" id="hiscore-submit">Submit your highscore!</button>
          </div>
        </form>
        <hr>
      </div>
      <div id="pop-highscore" style="display:none">
        <hr>
      </div>
    </div>
    <div id="sidebar-right">
      <div id="time"></div>
      <div id="points"></div>
      <div id="nplanets"></div>
      <div id="bonus"></div>
      <hr>
      <div id="planets-list"></div>
      <div id="highscores-list">
      </div>
      <div class="spacer"></div>
    </div>
    <div id="footer">
      <a class="spc"><span class="white-color">Super</span><span class="base0C">Planet</span><span class="base0A">Crush</span></a> is a project by <a href="http://www.stefanom.org">Stefano Meschiari</a>. 
      <a href="http://www.stefanom.org/post" class="pull-right">Read more...</a>

    </div>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" type="text/javascript"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js" type="text/javascript"></script>
    <script src="libs/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="js/colors.js?v=0.1" type="text/javascript"></script>
    <script src="js/utils.js?v=0.1" type="text/javascript"></script>
    <script src="js/pcl.js?v=0.1" type="text/javascript"></script>
    <script src="libs/paperjs_git/paper-full.min.js" type="text/javascript"></script>    
    <script src="js/ps.js?v=0.1" type="text/paperscript" canvas="universe"></script>
  </body>
</html>
